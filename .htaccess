# ========================================
# Feedbackspinne - Apache Security Configuration
# Addresses SECURITY_AUDIT.md Issue #8
# ========================================

# Disable directory listing
Options -Indexes

# ========================================
# HTTPS Enforcement (Optional - uncomment if needed)
# ========================================
# Uncomment these lines after verifying your SSL certificate is properly configured
# <IfModule mod_rewrite.c>
#     RewriteEngine On
#     RewriteCond %{HTTPS} off
#     RewriteCond %{HTTP:X-Forwarded-Proto} !https
#     RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [R=301,L]
# </IfModule>

# ========================================
# Sensitive File Protection
# ========================================

# Block access to .env files (most important!)
<Files ".env">
    Require all denied
</Files>

# Block access to .git directory
RedirectMatch 404 /\.git

# Block access to specific sensitive file patterns
<FilesMatch "\.(sql|bak|backup|swp|swo)$">
    Require all denied
</FilesMatch>

# Block .env variants (.env.local, .env.production, etc.)
<FilesMatch "^\.env">
    Require all denied
</FilesMatch>

# Block common backup and config files
<FilesMatch "(composer\.json|composer\.lock|package\.json|package-lock\.json|\.htpasswd|config\.php\.bak)$">
    Require all denied
</FilesMatch>

# ========================================
# Security Headers
# ========================================
<IfModule mod_headers.c>
    # Prevent MIME type sniffing
    Header set X-Content-Type-Options "nosniff"

    # Prevent clickjacking
    Header set X-Frame-Options "DENY"

    # Referrer policy
    Header set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>
